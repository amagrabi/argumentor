<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-51N4QB84CL"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-51N4QB84CL");
    </script>

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="howItWorksPage.title">How It Works - ArguMentor</title>
    <script
      type="module"
      src="{{ url_for('static', filename='js/translations.js') }}"
    ></script>
    <script src="https://cdn.tailwindcss.com"></script>
    {% include 'partials/favicons.html' %}
  </head>
  <body class="bg-white font-sans leading-normal tracking-normal text-gray-900">
    <!-- Header with Go Back Button -->
    <header class="bg-gray-800 p-4">
      <div class="max-w-5xl mx-auto flex justify-between items-center">
        <h1
          class="text-white text-3xl font-bold"
          data-i18n="howItWorksPage.title"
        >
          How It Works
        </h1>
        <a
          href="/"
          class="bg-gray-100 text-gray-800 px-3 py-1 rounded-full hover:bg-gray-200 transition-colors"
          data-i18n="howItWorksPage.goBack"
        >
        </a>
      </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-5xl mx-auto p-4">
      <!-- Updated Overview Section Using Translation Keys -->
      <section class="mb-8">
        <h2
          class="text-2xl font-bold mb-6"
          data-i18n="howItWorksPage.overviewTitle"
        ></h2>
        <p class="mb-8" data-i18n="howItWorksPage.overview"></p>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          <div
            class="bg-white p-3 md:p-4 rounded-xl border border-gray-200 flex items-start gap-3"
          >
            <div class="text-lg md:text-xl mb-2 text-gray-800">1️⃣</div>
            <div>
              <h3
                class="font-bold mb-2"
                data-i18n="howItWorksPage.section1.title"
              ></h3>
              <p
                class="text-sm text-gray-600"
                data-i18n="howItWorksPage.section1.description"
              ></p>
            </div>
          </div>
          <div
            class="bg-white p-3 md:p-4 rounded-xl border border-gray-200 flex items-start gap-3"
          >
            <div class="text-xl mb-2 text-gray-800">2️⃣</div>
            <div>
              <h3
                class="font-bold mb-2"
                data-i18n="howItWorksPage.section2.title"
              ></h3>
              <p
                class="text-sm text-gray-600"
                data-i18n="howItWorksPage.section2.description"
              ></p>
            </div>
          </div>
          <div
            class="bg-white p-3 md:p-4 rounded-xl border border-gray-200 flex items-start gap-3"
          >
            <div class="text-xl mb-2 text-gray-800">3️⃣</div>
            <div>
              <h3
                class="font-bold mb-2"
                data-i18n="howItWorksPage.section3.title"
              ></h3>
              <p
                class="text-sm text-gray-600"
                data-i18n="howItWorksPage.section3.description"
              ></p>
            </div>
          </div>
          <div
            class="bg-white p-3 md:p-4 rounded-xl border border-gray-200 flex items-start gap-3"
          >
            <div class="text-xl mb-2 text-gray-800">4️⃣</div>
            <div>
              <h3
                class="font-bold mb-2"
                data-i18n="howItWorksPage.section4.title"
              ></h3>
              <p
                class="text-sm text-gray-600"
                data-i18n="howItWorksPage.section4.description"
              ></p>
            </div>
          </div>
        </div>
      </section>

      <!-- User Profile and Progress Tracking Section -->
      <section class="mb-12">
        <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
          <img
            class="w-[22px] h-[22px] object-contain"
            src="https://img.icons8.com/windows/32/gender-neutral-user.png"
            alt="Profile"
          />
          <span data-i18n="howItWorksPage.profileSection.title"></span>
        </h2>
        <p
          class="mb-4"
          data-i18n="howItWorksPage.profileSection.description"
        ></p>
        <p
          class="mb-4"
          data-i18n="howItWorksPage.profileSection.detailedFeedback"
        ></p>
      </section>

      <!-- Challenge Section -->
      <section class="mb-12">
        <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
          ⚔️ <span data-i18n="howItWorksPage.challengeSection.title"></span>
        </h2>
        <p
          class="mb-4"
          data-i18n="howItWorksPage.challengeSection.description"
        ></p>
        <p
          class="mb-4"
          data-i18n="howItWorksPage.challengeSection.additionalInfo"
        ></p>
      </section>

      <!-- Evaluation Criteria Section -->
      <section id="evaluation_criteria" class="mb-12">
        <h2 class="text-2xl font-bold mb-4">
          <span data-i18n="howItWorksPage.evaluationCriteria.title"></span>
        </h2>
        <p
          class="mb-4 text-gray-700"
          data-i18n="howItWorksPage.evaluationCriteria.description"
        ></p>

        <div class="overflow-x-auto shadow-sm rounded-xl">
          <table class="min-w-full border-collapse">
            <thead>
              <tr>
                <th class="sticky top-0 border px-4 py-2 bg-gray-200 z-10"></th>
                {% for criterion in criteria.scoring_dimensions.keys() %}
                <th class="sticky top-0 border px-4 py-2 bg-gray-200 z-10">
                  {{ dimension_mapping[criterion] }}
                </th>
                {% endfor %}
              </tr>
            </thead>
            <tbody>
              {% for score in range(1, 11) %}
              <tr class="hover:bg-gray-50 transition-colors">
                <td class="border px-4 py-2 font-bold text-center bg-gray-100">
                  {{ score }}
                </td>
                {% for criterion, details in criteria.scoring_dimensions.items()
                %}
                <td class="border px-4 py-2 text-sm">
                  {{ details.levels[score|string] }}
                </td>
                {% endfor %}
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </section>

      <!-- Bottom Go Back Button -->
      <div class="text-center my-4">
        <a
          href="/"
          class="bg-gray-100 text-gray-800 px-4 py-2 rounded-full hover:bg-gray-200 transition-colors"
          data-i18n="howItWorksPage.goBack"
        >
        </a>
      </div>
    </main>

    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        // Get stored language preference
        const currentLanguage = localStorage.getItem("language") || "en";

        // Load translations
        const response = await fetch(
          `/static/translations/${currentLanguage}.json`
        );
        const translations = await response.json();

        // Apply translations
        document.querySelectorAll("[data-i18n]").forEach((element) => {
          const key = element.getAttribute("data-i18n");
          const translation = key
            .split(".")
            .reduce((obj, k) => obj && obj[k], translations);
          if (translation) {
            element.innerHTML = translation;
          }
        });

        // Update document language
        document.documentElement.lang = currentLanguage;
      });
    </script>
  </body>
</html>
